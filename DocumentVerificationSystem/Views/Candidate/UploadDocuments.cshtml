@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@if (TempData["Message"] != null)
{
    <div class="alert alert-success">@TempData["Message"]</div>
}

<div class="d-flex justify-content-between">
    <h2>Document Upload</h2>
    <a href="@Url.Action("Dashboard", "Candidate")" class="btn btn-outline-secondary">Back</a>
</div>

<ul class="nav nav-tabs" id="docTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="personal-tab" data-bs-toggle="tab" data-bs-target="#personal"
                type="button" role="tab" aria-controls="personal" aria-selected="true">
            Personal Identification
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="educational-tab" data-bs-toggle="tab" data-bs-target="#educational"
                type="button" role="tab" aria-controls="educational" aria-selected="false">
            Educational Documents
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="address-tab" data-bs-toggle="tab" data-bs-target="#address"
                type="button" role="tab" aria-controls="address" aria-selected="false">
            Address Proof
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="caste-tab" data-bs-toggle="tab" data-bs-target="#caste"
                type="button" role="tab" aria-controls="caste" aria-selected="false">
            Caste/Community
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="misc-tab" data-bs-toggle="tab" data-bs-target="#misc"
                type="button" role="tab" aria-controls="misc" aria-selected="false">
            Miscellaneous
        </button>
    </li>
</ul>

<div class="tab-content" id="docTabsContent" style="margin-top:20px;">

    <div class="tab-pane fade show active" id="personal" role="tabpanel" aria-labelledby="personal-tab">
        @Html.Partial("_PersonalDocuments")
    </div>

    <div class="tab-pane fade" id="educational" role="tabpanel" aria-labelledby="educational-tab">
        @Html.Partial("_EducationalDocuments")
    </div>

    <div class="tab-pane fade" id="address" role="tabpanel" aria-labelledby="address-tab">
        @Html.Partial("_AddressProof")
    </div>

    <div class="tab-pane fade" id="caste" role="tabpanel" aria-labelledby="caste-tab">
        @Html.Partial("_CasteDocuments")
    </div>

    <div class="tab-pane fade" id="misc" role="tabpanel" aria-labelledby="misc-tab">
        @Html.Partial("_MiscellaneousDocuments")
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var lastCategoryId = "@TempData["LastCategoryId"]";

        if (lastCategoryId) {
            var categoryMap = {
                0: "personal",
                1: "educational",
                2: "address",
                3: "caste",
                4: "misc",
            };

            var nextTabId = categoryMap[lastCategoryId];
            if (nextTabId) {
                var nextTabButton = document.querySelector(`[data-bs-target="#${nextTabId}"]`);
                if (nextTabButton) {
                    nextTabButton.click();
                }
            }
        }
    });
</script>

@* <script> *@
@*      document.addEventListener("DOMContentLoaded", function () { *@
@*         var urlParams = new URLSearchParams(window.location.search);  *@
@*         var categoryId = urlParams.get("categoryId"); *@

@*         function getTabIdByCategory(categoryId) { *@
@*              switch (parseInt(categoryId)) { *@
@*                  case 1: return "personal";  *@
@*                  case 2: return "educational"; *@
@*                  case 3: return "address"; *@
@*                 case 4: return "caste";  *@
@*                  case 5: return "misc";  *@
@*                  default: return "";  *@
@*              }  *@
@*          }  *@
@*          if (categoryId) { *@
@*              var tabButton = document.querySelector(`[data-bs-target="#${getTabIdByCategory(categoryId)}"]`); *@
@*              if (tabButton) { *@
@*                  tabButton.click(); *@
@*              }  *@
@*          }  *@
@*      }); *@
@* </script>  *@
